#! /bin/bash
#
# This script deletes the trash older than one month for every user.
#

readonly AMonth=$((31 * 24 * 60))

while IFS=\# read -r user zone
do
  if [ "$user" != "anonymous" -a "$user" != "rodsBoot" ]
  then
    printf 'removing trash for %s#%s\n' "$user" "$zone"
    irmtrash -M -u "$user" -z "$zone" --age "$AMonth"
  fi
done < <(iadmin lu | sort)
